========================================
    美颜相机 - 手机应用项目
========================================

项目简介
--------
本项目是将原有的数字图像处理美颜算法整合为手机应用程序，
支持实时运算，拍照时可实时看到美颜效果。

注意：手机已做正畸处理，无需棋盘格标定。


文件说明
--------

【核心文件】
main.py                 - 桌面版主程序（完整功能）
main_android.py         - Android版主程序（轻量级）
beautifier.py           - 美颜核心算法（完整版，使用dlib 68点检测）
beautifier_light.py     - 美颜核心算法（轻量版，不使用dlib）
beautycamera.kv         - Kivy UI样式定义

【配置文件】
buildozer.spec          - Buildozer配置（桌面/完整版）
buildozer_android.spec  - Buildozer配置（Android轻量版）
requirements.txt        - Python依赖列表

【文档】
README.md               - 项目详细说明文档
ANDROID_BUILD.md        - Android打包详细指南

【启动脚本】
run_desktop.bat         - Windows桌面版完整启动脚本
run_quick.bat           - Windows快速启动脚本

【模型文件】
shape_predictor_68_face_landmarks.dat - dlib 68点人脸特征点检测模型


使用说明
--------

1. Windows桌面版运行
   方式A - 自动配置（推荐）:
       双击运行 run_desktop.bat
       脚本会自动创建虚拟环境并安装依赖
   
   方式B - 快速启动（已配置好环境）:
       双击运行 run_quick.bat
   
   方式C - 手动运行:
       python main.py

2. Android打包
   方案1 - 使用Buildozer（Linux环境）:
       参考 ANDROID_BUILD.md
       完整功能需要编译dlib，较复杂
   
   方案2 - 使用Buildozer轻量版:
       cp main_android.py main.py
       cp beautifier_light.py beautifier.py
       buildozer -v android debug
   
   方案3 - 使用Chaquopy（推荐新手）:
       在Android Studio中配置Chaquopy插件
       参考 ANDROID_BUILD.md 详细步骤


功能对比
--------

【桌面完整版】
- ✅ dlib 68点人脸特征点检测
- ✅ 智能磨皮（双边滤波+NLM降噪）
- ✅ 皮肤美白（模板直方图匹配）
- ✅ 眼睛放大（MLS变形）
- ✅ 瘦脸（RBF插值）
- ✅ 嘴唇增强
- ✅ 实时预览（约15-30fps，取决于硬件）

【Android轻量版】
- ✅ OpenCV DNN/Haar人脸检测
- ✅ 智能磨皮（双边滤波+肤色检测）
- ✅ 皮肤美白（LAB亮度提升）
- ✅ 全局亮度/对比度调整
- ❌ 眼睛放大（无特征点）
- ❌ 瘦脸（无特征点）
- ❌ 嘴唇增强（无特征点）
- ✅ 实时预览（约20-30fps）


界面操作
--------

美颜开关     - 开启/关闭美颜效果
📷 拍照按钮  - 拍摄并保存照片
切换摄像头   - 切换前置/后置摄像头（桌面版）

参数调节滑块:
磨皮     - 调整皮肤平滑程度 (0-100%)
美白     - 调整皮肤亮度 (0-100%)
大眼     - 调整眼睛放大比例 (1.0-1.5x) [仅完整版]
瘦脸     - 调整瘦脸强度 (0-10%) [仅完整版]
亮度     - 调整整体亮度 [轻量版]


照片保存位置
------------

Android:
    /storage/emulated/0/DCIM/BeautyCamera/

Windows:
    C:\Users\[用户名]\Pictures\BeautyCamera\


注意事项
--------

1. 人脸检测需要光线充足的环境
2. 确保摄像头权限已授予
3. 模型文件 shape_predictor_68_face_landmarks.dat 约97MB，
   已包含在项目目录中
4. Android打包需要Linux环境或Docker
5. 完整版在Android上编译较复杂，建议使用轻量版或Chaquopy方案


依赖要求
--------

Python 3.8+
OpenCV 4.x
Kivy 2.x
NumPy
dlib（仅完整版）


技术说明
--------

原项目的相机标定功能已移除，因为：
- 现代智能手机已经做过镜头畸变校正
- 前置摄像头的畸变通常很小
- 简化了移动端部署

美颜算法优化：
- 降采样处理：大尺寸图像先缩放再处理
- 隔帧检测：人脸检测每3帧执行一次
- 快速算法：使用双边滤波代替NLM降噪
- 区域裁剪：只在人脸区域内处理


联系方式
--------

如有问题请参考 README.md 和 ANDROID_BUILD.md
